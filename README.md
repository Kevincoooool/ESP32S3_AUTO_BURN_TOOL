# ESP32 自动烧录工具

一个功能强大的 ESP32 系列芯片多端口并行烧录和MAC地址读取工具，支持自动检测芯片类型和批量操作。

[![Python Version](https://img.shields.io/badge/python-3.8%2B-blue)](https://www.python.org/)
[![License](https://img.shields.io/badge/license-MIT-green)](LICENSE)
[![Platform](https://img.shields.io/badge/platform-Windows-lightgrey)](https://www.microsoft.com/windows)

---

## 📚 文档导航

| 文档 | 说明 | 适用人群 |
|------|------|---------|
| [用户使用指南.md](用户使用指南.md) | 从零开始安装Python和依赖 | 新手用户、首次使用 |
| [打包发布指南.md](打包发布指南.md) | 如何打包成.exe可执行文件 | 开发者、需要分发 |
| [免安装使用说明.md](免安装使用说明.md) | 使用已打包的.exe文件 | 最终用户、无需编程 |
| [代码优化说明.md](代码优化说明.md) | 代码优化和Bug修复记录 | 开发者、维护人员 |

---

## ✨ 功能特点

### 🔥 ESP32 固件烧录工具 (esp32_flasher.py)

- ✅ **多串口并行烧录**：最多支持8个串口同时烧录
- ✅ **自动芯片检测**：ESP32/S2/S3/C3/C6/P4 自动识别
- ✅ **多固件支持**：可同时烧录8个不同固件文件
- ✅ **自动烧录模式**：插入设备自动开始烧录
- ✅ **擦除Flash功能**：可选完全擦除后再烧录
- ✅ **高速烧录**：支持最高2000000波特率
- ✅ **配置自动保存**：固件路径和参数自动记忆
- ✅ **实时日志**：每个端口独立日志窗口

### 📱 ESP32 MAC地址读取工具 (esp32_readmac.py)

- ✅ **批量读取**：支持多串口同时读取
- ✅ **自动读取模式**：插入设备自动识别并读取
- ✅ **芯片类型识别**：自动识别ESP32系列芯片
- ✅ **去重功能**：自动跳过已读取的MAC地址
- ✅ **导出功能**：支持TXT和CSV格式导出
- ✅ **自动保存**：所有MAC地址实时保存到文件
- ✅ **波特率可调**：115200-1500000可选

---

## 🎯 支持的芯片

| 芯片型号 | 状态 | Flash大小 | 特点 |
|---------|------|-----------|------|
| ESP32 | ✅ 支持 | 4MB | 经典款，双核 |
| ESP32-S2 | ✅ 支持 | 4MB | 单核，USB原生 |
| ESP32-S3 | ✅ 支持 | 8/16MB | 双核，AI加速 |
| ESP32-C3 | ✅ 支持 | 4MB | RISC-V单核 |
| ESP32-C6 | ✅ 支持 | 4MB | RISC-V+WiFi6 |
| ESP32-P4 | ✅ 支持 | - | 高性能 |

---

## 🚀 快速开始

### 方式一：使用Python源码（推荐开发者）

#### 1. 安装Python环境

确保已安装 Python 3.8 或更高版本。详细安装步骤请参考 [用户使用指南.md](用户使用指南.md)

#### 2. 安装依赖

```bash
# 克隆或下载项目
cd ESP32S3_AUTO_BURN_TOOL

# 安装依赖
pip install -r requirements.txt
```

#### 3. 运行工具

```bash
# 运行MAC地址读取工具
python esp32_readmac.py

# 运行固件烧录工具
python esp32_flasher.py
```

### 方式二：使用打包的.exe文件（推荐普通用户）

#### 1. 获取.exe文件

```bash
# 方式A：自己打包
build.bat

# 方式B：从发布页面下载
# 查看 dist/ 文件夹中的 esp32_readmac.exe 和 esp32_flasher.exe
```

#### 2. 直接运行

双击 `esp32_readmac.exe` 或 `esp32_flasher.exe` 即可使用。

详细说明请参考 [免安装使用说明.md](免安装使用说明.md)

---

## 📖 使用教程

### MAC地址读取工具使用流程

```
1. 打开程序
   ├─ python esp32_readmac.py
   └─ 或双击 esp32_readmac.exe

2. 配置设置
   ├─ 选择波特率（推荐115200）
   ├─ 勾选"自动读取MAC地址"
   └─ 选择要启用的串口

3. 开始读取
   ├─ 点击"开始读取MAC地址"
   └─ 或插入设备（自动模式）

4. 查看结果
   ├─ MAC地址显示在列表中
   ├─ 自动保存到文件
   └─ 可点击"导出列表"保存

5. 清空列表
   └─ 点击"清空列表"重新开始
```

### 固件烧录工具使用流程

```
1. 打开程序
   ├─ python esp32_flasher.py
   └─ 或双击 esp32_flasher.exe

2. 选择固件
   ├─ 勾选要烧录的固件
   ├─ 点击"浏览"选择.bin文件
   └─ 设置烧录地址（如0x1000）

3. 配置参数
   ├─ 选择波特率（推荐921600）
   ├─ 勾选"擦除Flash"（可选）
   └─ 勾选"自动烧录"（可选）

4. 选择串口
   ├─ 点击"刷新"检测串口
   └─ 勾选要烧录的串口

5. 开始烧录
   ├─ 点击"开始烧录"
   └─ 或插入设备（自动模式）

6. 查看进度
   └─ 在独立日志窗口查看进度
```

---

## 🔧 常用烧录地址

| 文件类型 | 地址 | 说明 |
|---------|------|------|
| Bootloader | 0x1000 | 引导加载程序 |
| Partition Table | 0x8000 | 分区表 |
| OTA Data | 0xd000 | OTA数据初始化 |
| Application | 0x10000 | 主应用程序 |
| NVS | 0x9000 | 非易失性存储 |

---

## ⚙️ 项目结构

```
ESP32S3_AUTO_BURN_TOOL/
├── esp32_readmac.py           # MAC地址读取工具（源代码）
├── esp32_flasher.py           # 固件烧录工具（源代码）
├── requirements.txt           # Python依赖列表
├── build.bat                  # 一键打包脚本
├── esp32_readmac.spec        # MAC工具打包配置
├── esp32_flasher.spec        # 烧录工具打包配置
│
├── 用户使用指南.md            # 新手入门教程
├── 打包发布指南.md            # 打包发布教程
├── 免安装使用说明.md          # .exe使用说明
├── 代码优化说明.md            # 代码优化记录
├── README.md                 # 项目说明（本文件）
│
├── mac_reader_config.json    # MAC工具配置文件
├── config.json               # 烧录工具配置文件
│
├── dist/                     # 打包后的可执行文件
│   ├── esp32_readmac.exe
│   └── esp32_flasher.exe
│
└── build/                    # 打包临时文件
```

---

## 📦 依赖库

| 库名 | 版本要求 | 用途 |
|------|---------|------|
| esptool | >=4.6.2 | ESP32烧录和通信 |
| pyserial | >=3.5 | 串口通信 |
| pyinstaller | >=6.0.0 | 打包成.exe（可选） |
| tkinter | 内置 | 图形界面 |

---

## 🎨 界面预览

### MAC地址读取工具

```
┌─────────────────────────────────────────┐
│ ESP32 MAC地址读取工具                    │
├─────────────────────────────────────────┤
│ 串口设置                                 │
│ ☑ 串口1: COM3        ☑ 串口5:          │
│ ☑ 串口2: COM4        ☐ 串口6:          │
│ ☑ 串口3: COM5        ☐ 串口7:          │
│ ☐ 串口4:             ☐ 串口8:          │
│            [刷新]                        │
├─────────────────────────────────────────┤
│ 读取设置                                 │
│ ☑ 自动读取MAC地址  波特率: 115200       │
│ 当前日志: MAC_Addresses_20251011.txt    │
├─────────────────────────────────────────┤
│ [开始读取] [导出列表] [清空列表]         │
├─────────────────────────────────────────┤
│ MAC地址列表                              │
│ 端口   MAC地址            芯片   时间    │
│ COM3  48:27:E2:XX:XX:XX  S3   15:30:12 │
│ COM4  48:27:E2:XX:XX:XX  S3   15:30:15 │
├─────────────────────────────────────────┤
│ 日志                    [清除日志]       │
│ [2025-10-11 15:30:10] 程序启动...      │
│ [2025-10-11 15:30:12] 读取成功         │
└─────────────────────────────────────────┘
```

### 固件烧录工具

```
┌─────────────────────────────────────────┐
│ ESP32烧录工具                            │
├─────────────────────────────────────────┤
│ 串口设置                                 │
│ ☑ 串口1: COM3        ☐ 串口5:          │
│ ☑ 串口2: COM4        ☐ 串口6:          │
│ ☐ 串口3:             ☐ 串口7:          │
│ ☐ 串口4:             ☐ 串口8:          │
│            [刷新]                        │
├─────────────────────────────────────────┤
│ 固件设置                                 │
│ ☑ bootloader.bin           0x1000  [浏览]│
│ ☑ partition-table.bin      0x8000  [浏览]│
│ ☑ app.bin                  0x10000 [浏览]│
│ ☐                          0x0     [浏览]│
├─────────────────────────────────────────┤
│ 烧录设置                                 │
│ 波特率: 921600  ☐擦除Flash  ☐自动烧录  │
├─────────────────────────────────────────┤
│              [开始烧录]                  │
├─────────────────────────────────────────┤
│ 日志                    [清除日志]       │
│ [2025-10-11 15:35:10] 开始烧录...      │
│ [2025-10-11 15:35:25] 烧录成功         │
└─────────────────────────────────────────┘
```

---

## 💡 使用技巧

### 提高读取效率

1. **使用自动读取模式**
   - 勾选"自动读取MAC地址"
   - 按顺序插入设备
   - 等待自动完成

2. **调整波特率**
   - 稳定连接：115200
   - 快速读取：460800或更高

3. **批量导出**
   - 读取完成后点击"导出列表"
   - 选择CSV格式可用Excel处理

### 提高烧录效率

1. **多串口并行**
   - 使用USB集线器
   - 同时选择多个串口
   - 并行烧录提高效率

2. **优化波特率**
   - 稳定首选：460800-921600
   - USB 3.0：1500000-2000000

3. **使用自动烧录**
   - 配置好固件后勾选"自动烧录"
   - 插入设备自动开始

### 故障排除

1. **无法识别串口**
   - 安装CH340或CP2102驱动
   - 更换USB数据线
   - 尝试不同USB端口

2. **烧录失败**
   - 降低波特率
   - 手动进入下载模式（按住BOOT+RST）
   - 勾选"擦除Flash"

3. **程序闪退**
   - 以管理员身份运行
   - 添加到杀毒软件白名单
   - 查看日志文件

---

## 🔒 安全说明

1. **数据备份**：烧录前请备份重要数据
2. **固件验证**：确认固件文件完整无误
3. **防止断电**：烧录过程中保持供电稳定
4. **驱动安全**：从官方渠道下载USB驱动

---

## 📊 性能指标

| 指标 | 数值 | 说明 |
|------|------|------|
| MAC读取速度 | 2-5秒/个 | 取决于波特率 |
| 固件烧录速度 | 10-30秒 | 取决于固件大小和波特率 |
| 并行串口数 | 最多8个 | 受USB供电限制 |
| 支持固件数 | 最多8个 | 单次烧录 |
| 最高波特率 | 2000000 | 需USB 3.0支持 |

---

## 🤝 贡献指南

欢迎提交Issue和Pull Request！

### 提交Bug报告

请包含以下信息：
- 操作系统版本
- Python版本
- 详细的错误信息
- 复现步骤

### 提交功能建议

请说明：
- 功能描述
- 使用场景
- 预期效果

---

## 📜 许可证

MIT License

---

## 📞 联系方式

- **Issues**: 在GitHub上提交问题
- **Email**: 通过项目页面联系
- **文档**: 查看项目中的Markdown文档

---

## 🎉 致谢

感谢以下开源项目：

- [esptool](https://github.com/espressif/esptool) - ESP32烧录工具
- [pyserial](https://github.com/pyserial/pyserial) - Python串口库
- [PyInstaller](https://pyinstaller.org/) - Python打包工具

---

## 📝 更新日志

### v1.1.0 (2025-10-11)

#### 新增功能
- ✨ MAC地址导出功能（TXT/CSV）
- ✨ MAC列表清空功能
- ✨ 波特率配置选项
- ✨ 擦除Flash功能
- ✨ 完整的用户文档

#### Bug修复
- 🐛 修复未导入messagebox的问题
- 🐛 修复重复的MAC检测逻辑
- 🐛 修复线程安全问题
- 🐛 修复重复定义的monitor_ports方法
- 🐛 删除未使用的detect_chip方法
- 🐛 修复firmware_path引用错误

#### 优化改进
- ⚡ 提升MAC检测性能
- ⚡ 优化烧录速度（添加-z压缩）
- ⚡ 改进配置文件格式
- ⚡ 增强线程安全性
- ⚡ 删除约100行冗余代码

### v1.0.0 (初始版本)

- 基础的MAC读取功能
- 基础的固件烧录功能
- 支持多串口
- 支持自动检测芯片

---

## 🌟 Star History

如果这个项目对您有帮助，请给我们一个 Star ⭐

---

**最后更新**: 2025-10-11  
**版本**: v1.1.0  
**维护状态**: 🟢 积极维护中
