# ESP32 自动烧录工具 - 免安装版使用说明

> 本说明适用于已经打包好的 .exe 可执行文件版本

---

## 🎯 适用人群

- ✅ 不想安装 Python 的用户
- ✅ 只需要使用工具，不需要修改代码的用户
- ✅ 快速部署到多台电脑的用户

---

## 📦 文件说明

您应该收到以下文件：

```
ESP32_Tool/
├── esp32_readmac.exe       # MAC 地址读取工具
├── esp32_flasher.exe       # 固件烧录工具
├── mac_reader_config.json  # MAC 读取工具配置文件（自动生成）
└── config.json            # 烧录工具配置文件（自动生成）
```

**注意**：配置文件会在第一次运行时自动创建，无需手动准备。

---

## 🚀 快速开始

### 1️⃣ 准备工作

#### 连接设备：
1. 使用 USB 数据线将 ESP32 开发板连接到电脑
2. 确保数据线支持数据传输（不是仅充电线）
3. 检查设备管理器中是否出现 COM 口

#### 安装驱动（如果需要）：

**检查是否需要驱动**：
- 打开"设备管理器"（Win + X，选择"设备管理器"）
- 查看"端口(COM和LPT)"下是否有设备
- 如果有黄色感叹号或问号，说明需要安装驱动

**常见芯片驱动**：

| USB 芯片型号 | 驱动下载链接 |
|-------------|------------|
| CH340/CH341 | https://www.wch.cn/downloads/CH341SER_EXE.html |
| CP2102/CP2104 | https://www.silabs.com/developers/usb-to-uart-bridge-vcp-drivers |
| FTDI | https://ftdichip.com/drivers/vcp-drivers/ |

---

### 2️⃣ 使用 MAC 地址读取工具

**功能**：批量读取 ESP32 芯片的 MAC 地址

#### 使用步骤：

1. **双击运行** `esp32_readmac.exe`
2. 程序会自动弹出图形界面
3. **点击"刷新串口"** 按钮，程序会自动检测所有可用的 COM 口
4. **选择串口**：在列表中勾选要读取的串口（支持多选）
5. **设置自动读取**（可选）：
   - 勾选"自动读取MAC"：插入新设备时自动开始读取
   - 设置读取间隔：建议 5-10 秒
6. **点击"开始读取"** 按钮
7. 程序会显示读取进度和结果
8. 读取完成后，MAC 地址会自动保存到文本文件

#### 结果文件：

MAC 地址会保存在程序目录下的 `MAC_Addresses_YYYYMMDD_HHMMSS.txt` 文件中：

```
=== ESP32 MAC地址列表 ===
读取时间: 2025-10-11 15:56:12
总数量: 3

1. MAC: 48:27:E2:12:34:56 - 类型: ESP32-S3 - 端口: COM3 - 时间: 15:56:12
2. MAC: 48:27:E2:12:34:57 - 类型: ESP32-S3 - 端口: COM4 - 时间: 15:56:15
3. MAC: 48:27:E2:12:34:58 - 类型: ESP32-S3 - 端口: COM5 - 时间: 15:56:18
```

---

### 3️⃣ 使用固件烧录工具

**功能**：给 ESP32 芯片烧录固件

#### 使用步骤：

1. **双击运行** `esp32_flasher.exe`
2. 程序会自动弹出图形界面

#### 配置固件：

3. **添加固件文件**：
   - 点击"选择固件"按钮
   - 选择 .bin 格式的固件文件
   - 设置烧录地址（常见地址见下表）
   - 最多支持添加 8 个固件文件

| 固件类型 | 烧录地址 | 说明 |
|---------|---------|------|
| Bootloader | 0x1000 | 引导加载程序 |
| Partition Table | 0x8000 | 分区表 |
| Application | 0x10000 | 应用程序 |
| OTA Data | 0xd000 | OTA 数据 |

4. **选择串口**：
   - 点击"刷新串口"
   - 选择要烧录的串口（支持多串口并行烧录）

5. **配置参数**：
   - **波特率**：建议 921600 或 1500000（更快）
   - **芯片类型**：选择"自动检测"或手动选择
   - **擦除设置**：
     - 不擦除：仅烧录新固件
     - 擦除 Flash：完全擦除后再烧录（推荐）

6. **开始烧录**：
   - 点击"开始烧录"按钮
   - 观察日志窗口，查看烧录进度
   - 等待提示"烧录成功"

#### 高级功能：

- **自动烧录**：勾选后，插入新设备会自动开始烧录
- **多串口并行**：可同时烧录多个设备
- **配置保存**：程序会自动保存您的配置，下次打开自动加载

---

## ⚠️ 常见问题

### 问题 1：双击 .exe 后没有反应

**可能原因**：
- 被杀毒软件拦截
- 程序正在后台加载（首次启动较慢）

**解决方法**：
1. 查看任务管理器，是否有程序在运行
2. 等待 10-15 秒（首次启动需要解压）
3. 将 .exe 添加到杀毒软件白名单
4. 右键 .exe，选择"以管理员身份运行"

---

### 问题 2：提示"找不到串口"

**可能原因**：
- USB 驱动未安装
- 数据线不支持数据传输
- 设备未正确连接

**解决方法**：
1. 打开设备管理器，查看是否有 COM 口
2. 如果有黄色感叹号，安装对应的 USB 驱动
3. 更换数据线
4. 重新插拔 USB 连接
5. 点击程序中的"刷新串口"按钮

---

### 问题 3：烧录失败，提示"连接超时"

**可能原因**：
- 芯片未进入下载模式
- 波特率设置过高
- USB 供电不足

**解决方法**：
1. **手动进入下载模式**：
   - 按住 BOOT 按钮
   - 按一下 RST（复位）按钮
   - 松开 BOOT 按钮
   - 重新点击"开始烧录"

2. **降低波特率**：
   - 将波特率改为 115200 或 460800
   - 重新尝试烧录

3. **更换 USB 口**：
   - 使用主板后置 USB 口（供电更稳定）
   - 避免使用 USB 集线器

---

### 问题 4：Windows 提示"无法验证发布者"

**这是正常的安全提示**，因为程序没有数字签名。

**解决方法**：
1. 点击"更多信息"
2. 点击"仍要运行"
3. 或将程序添加到 Windows Defender 白名单

---

### 问题 5：MAC 地址重复读取

**可能原因**：
- 设备未移除就再次读取
- 自动读取间隔设置过短

**解决方法**：
1. 读取完一个设备后，先拔掉再插下一个
2. 增加自动读取间隔时间（建议 10 秒以上）
3. 点击"清空列表"重新开始

---

### 问题 6：程序启动很慢

**原因**：PyInstaller 打包的程序首次启动需要解压

**这是正常现象**：
- 首次启动：10-20 秒
- 后续启动：会快一些
- 如需更快，可以考虑使用源代码版本

---

### 问题 7：读取 MAC 地址时提示"芯片检测失败"

**可能原因**：
- 芯片未正确连接
- 波特率设置不当
- 芯片已损坏

**解决方法**：
1. 检查硬件连接
2. 尝试手动复位芯片
3. 降低波特率重试
4. 在设备管理器中确认 COM 口正常
5. 更换另一块板子测试

---

## 💡 使用技巧

### 技巧 1：批量读取 MAC 地址

1. 勾选"自动读取MAC"
2. 设置合适的间隔时间（如 5 秒）
3. 点击"开始读取"
4. 按顺序插入多个设备
5. 每个设备插入后等待读取完成再拔掉
6. 全部读取完成后，点击"导出列表"保存

### 技巧 2：多串口并行烧录

1. 使用 USB 集线器连接多个设备
2. 在"串口选择"中选择所有 COM 口
3. 点击"开始烧录"
4. 程序会自动并行烧录所有设备
5. 大幅提高烧录效率

### 技巧 3：快速重复烧录

1. 第一次配置好固件和参数后，程序会自动保存
2. 下次打开程序，直接选择串口
3. 点击"开始烧录"即可
4. 无需重新配置

### 技巧 4：查看详细日志

1. 程序运行时，所有操作都会在日志窗口显示
2. 如果出现问题，查看日志中的错误信息
3. 可以右键日志区域，复制错误信息用于排查

---

## 📊 性能参考

| 操作 | 平均耗时 | 说明 |
|------|---------|------|
| 程序启动 | 3-10 秒 | 首次启动较慢 |
| 读取 MAC | 2-5 秒/个 | 取决于波特率 |
| 烧录固件 | 10-30 秒/个 | 取决于固件大小和波特率 |
| 芯片检测 | 1-3 秒 | 自动检测芯片型号 |

### 波特率对比：

| 波特率 | 烧录速度 | 稳定性 | 推荐场景 |
|--------|---------|--------|---------|
| 115200 | ★☆☆☆☆ | ★★★★★ | 连接不稳定时 |
| 460800 | ★★☆☆☆ | ★★★★☆ | 一般使用 |
| 921600 | ★★★☆☆ | ★★★☆☆ | 推荐使用 |
| 1500000 | ★★★★☆ | ★★☆☆☆ | USB 3.0 端口 |
| 2000000 | ★★★★★ | ★☆☆☆☆ | 高性能场景 |

---

## 📁 配置文件说明

### mac_reader_config.json

保存 MAC 读取工具的配置：

```json
{
    "baudrate": 115200,          // 波特率
    "auto_read": true,           // 是否自动读取
    "interval": 5,               // 读取间隔（秒）
    "last_port": "COM3"          // 上次使用的串口
}
```

### config.json

保存固件烧录工具的配置：

```json
{
    "baudrate": 921600,          // 烧录波特率
    "chip": "auto",              // 芯片类型
    "erase_flash": true,         // 是否擦除 Flash
    "auto_burn": false,          // 是否自动烧录
    "files": [                   // 固件文件列表
        {
            "path": "bootloader.bin",
            "address": "0x1000"
        },
        {
            "path": "app.bin",
            "address": "0x10000"
        }
    ]
}
```

**提示**：这些文件可以手动编辑，但建议通过程序界面修改。

---

## 🎯 推荐工作流程

### 生产环境批量烧录：

```
1. 准备工作
   ├─ 准备好所有固件文件
   ├─ 连接 USB 集线器
   └─ 打开烧录工具，配置好参数

2. 烧录流程
   ├─ 插入第一批设备（如 4 个）
   ├─ 选择所有串口
   ├─ 点击"开始烧录"
   ├─ 等待全部完成
   ├─ 拔掉已烧录的设备
   └─ 重复上述步骤

3. 读取 MAC
   ├─ 打开 MAC 读取工具
   ├─ 勾选"自动读取"
   ├─ 按顺序插入设备
   ├─ 等待自动读取完成
   └─ 导出 MAC 地址列表
```

---

## 🔐 安全说明

1. **来源可靠**：确保从官方渠道获取程序
2. **杀毒扫描**：建议先用杀毒软件扫描
3. **权限控制**：不要随意给予管理员权限
4. **备份重要固件**：烧录前备份原始固件（如果需要）

---

## 📞 技术支持

如遇到问题：

1. **查看本文档**的常见问题部分
2. **查看程序日志**，记录错误信息
3. **联系技术支持**，提供详细的错误描述

---

## 🎉 快速参考卡

**MAC 读取工具**：
```
1. 双击 esp32_readmac.exe
2. 刷新串口 → 选择串口
3. 点击"开始读取"
4. 查看结果 → 导出列表
```

**固件烧录工具**：
```
1. 双击 esp32_flasher.exe
2. 选择固件文件 → 设置地址
3. 刷新串口 → 选择串口
4. 配置参数 → 开始烧录
5. 等待完成
```

---

**最后更新**：2025-10-11

**祝使用愉快！** 🚀

