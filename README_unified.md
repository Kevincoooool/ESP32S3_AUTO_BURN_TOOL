# ESP32 统一工具 - 刷固件 & 读取MAC地址

## 功能简介

这是一个整合了ESP32刷固件和读取MAC地址功能的统一工具，具有现代化的图形界面。

## 主要功能

### 1. 自动模式
- **自动检测设备**: 当ESP32设备连接到电脑时，工具会自动检测
- **自动执行操作**: 可以选择自动刷固件和/或自动读取MAC地址
- **智能识别**: 自动识别ESP32、ESP32-S2、ESP32-S3、ESP32-C3等芯片类型

### 2. 手动操作
- **手动刷固件**: 可以手动选择端口进行固件刷写
- **手动读取MAC**: 可以手动选择端口读取MAC地址
- **灵活控制**: 不依赖自动模式，完全手动控制操作流程

### 3. 固件配置
- **多固件支持**: 支持最多8个固件文件同时配置
- **地址设置**: 每个固件可以设置不同的烧写地址
- **灵活启用**: 可以选择性启用需要的固件

### 4. 串口管理
- **自动检测**: 自动检测可用串口
- **选择性操作**: 可以选择特定串口进行操作
- **状态记忆**: 记住串口选择状态

### 5. MAC地址记录
- **实时显示**: 在界面中实时显示读取到的MAC地址
- **自动保存**: 自动保存MAC地址到文件
- **记录导出**: 可以导出MAC地址记录到文件

### 6. 日志系统
- **详细日志**: 显示详细的操作日志
- **实时更新**: 实时显示操作进度
- **日志管理**: 可以清除日志内容

## 使用方法

### 1. 启动程序
```bash
python esp32_unified_tool.py
```
或者双击运行：
```
run_unified_tool.bat
```

### 2. 模式选择

#### 自动模式
1. 勾选"自动模式"复选框
2. 选择需要的自动操作：
   - 自动刷固件
   - 自动读取MAC地址
3. 连接ESP32设备，工具会自动执行选定的操作

#### 手动模式
1. 取消勾选"自动模式"
2. 配置固件文件（如需刷固件）
3. 选择要操作的串口
4. 点击"手动刷固件"或"手动读取MAC"按钮

### 3. 固件配置
1. 勾选要使用的固件编号
2. 设置烧写地址（如0x0, 0x8000等）
3. 选择固件文件路径

### 4. 串口配置
1. 点击"刷新串口"更新串口列表
2. 选择要操作的串口
3. 使用"全选"/"全不选"快速设置

## 配置文件

程序使用 `unified_config.json` 文件保存配置：

```json
{
  "firmware_paths": ["", "", "", "", "", "", "", ""],
  "firmware_addresses": ["0x0", "0x8000", "0xe000", "0x10000", "0x0", "0x0", "0x0", "0x0"],
  "firmware_enables": [false, false, false, false, false, false, false, false],
  "port_enables": [true, true, true, true, true, true, true, true],
  "auto_mode": true,
  "auto_flash": true,
  "auto_read_mac": true
}
```

## 输出文件

### MAC地址记录
- 文件名格式：`ESP32_MAC_Addresses_YYYYMMDD_HHMMSS.txt`
- 内容格式：时间\t端口\t芯片类型\tMAC地址

## 系统要求

- Python 3.6+
- pyserial
- esptool
- tkinter (通常随Python安装)

## 安装依赖

```bash
pip install -r requirements.txt
```

## 常见问题

### 1. 串口无法检测
- 确保ESP32设备已正确连接
- 检查驱动程序是否已安装
- 点击"刷新串口"按钮

### 2. 刷固件失败
- 检查固件文件路径是否正确
- 确认烧写地址设置正确
- 检查串口是否被其他程序占用

### 3. MAC地址读取失败
- 确保设备处于正常状态
- 检查esptool是否正确安装
- 尝试手动操作模式

## 注意事项

1. **单一界面**: 所有功能都在一个主界面中，不会弹出额外窗口
2. **配置保存**: 程序会自动保存配置，下次启动时恢复
3. **日志记录**: 所有操作都有详细的日志记录
4. **线程安全**: 支持同时处理多个串口
5. **自动检测**: 支持自动检测不同类型的ESP32芯片

## 技术特点

- **现代UI**: 使用Windows现代风格界面
- **响应式设计**: 界面元素自适应大小
- **多线程处理**: 不阻塞用户界面
- **配置管理**: 智能保存和恢复配置
- **错误处理**: 完善的错误处理机制 